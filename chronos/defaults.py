GPU_SPECS = {
    "A100": {
        "Base Clock (MHz)": 1065,
        "Boost Clock (MHz)": 1410,
        "Memory Clock (MHz)": 1512,
        "Memory (GB)": 80,
        "Memory Type": "HBM2e",
        "Memory Bus (bit)": 5120,
        "GPU Memory Bandwidth (GB/s)": 1940,
        "Bus": "PCIe 4.0",
        "Cores": 6912,
        "TMUs": 432,
        "ROPs": 160,
        "SM": 108,
        "TC": 432,
        "RT": 0,
        "PR": 226,
        "TR": 609.0,
        "FP16": 77970,
        "FP32": 19490,
        "FP64": 9746.0,
        "$/hr": 1.64
    },
    "V100": {
        "Base Clock (MHz)": 1312,
        "Boost Clock (MHz)": 1530,
        "Memory Clock (MHz)": 876,
        "Memory (GB)": 16,
        "Memory Type": "HBM2",
        "Memory Bus (bit)": 4096,
        "GPU Memory Bandwidth (GB/s)": 897,
        "Bus": "PCIe 4.0",
        "Cores": 5120,
        "TMUs": 320,
        "ROPs": 128,
        "SM": 80,
        "TC": 640,
        "RT": 0,
        "PR": 195,
        "TR": 490.0,
        "FP16": 31330,
        "FP32": 15670,
        "FP64": 7834.0,
        "$/hr": 1.77
    },
    "T4": {
        "Base Clock (MHz)": 585,
        "Boost Clock (MHz)": 1590,
        "Memory Clock (MHz)": 1250,
        "Memory (GB)": 16,
        "Memory Type": "GDDR6",
        "Memory Bus (bit)": 256,
        "GPU Memory Bandwidth (GB/s)": 320,
        "Bus": "PCIe 4.0",
        "Cores": 2560,
        "TMUs": 160,
        "ROPs": 64,
        "SM": 40,
        "TC": 320,
        "RT": 40,
        "PR": 101,
        "TR": 254.0,
        "FP16": 65130,
        "FP32": 8141,
        "FP64": 254.0,
        "$/hr": 0.28
    },
    "H100": {
        "Base Clock (MHz)": 1095,
        "Boost Clock (MHz)": 1755,
        "Memory Clock (MHz)": 1593,
        "Memory (GB)": 80,
        "Memory Type": "HBM2e",
        "Memory Bus (bit)": 5120,
        "GPU Memory Bandwidth (GB/s)": 2040,
        "Bus": "PCIe 5.0",
        "Cores": 14592,
        "TMUs": 456,
        "ROPs": 24,
        "SM": 114,
        "TC": 456,
        "RT": 0,
        "PR": 42,
        "TR": 800.0,
        "FP16": 204900,
        "FP32": 51220,
        "FP64": 25610.0,
        "$/hr": 2.39
    },
    "A40": {
        "Base Clock (MHz)": 1305,
        "Boost Clock (MHz)": 1740,
        "Memory Clock (MHz)": 1812,
        "Memory (GB)": 48,
        "Memory Type": "GDDR6",
        "Memory Bus (bit)": 384,
        "GPU Memory Bandwidth (GB/s)": 696,
        "Bus": "PCIe 4.0",
        "Cores": 10752,
        "TMUs": 336,
        "ROPs": 112,
        "SM": 84,
        "TC": 336,
        "RT": 84,
        "PR": 195,
        "TR": 585.0,
        "FP16": 37420,
        "FP32": 37420,
        "FP64": 584.6,
        "$/hr": 0.4
    },
    "RTX5090": {
        "Base Clock (MHz)": 2017,
        "Boost Clock (MHz)": 2407,
        "Memory Clock (MHz)": 1750,
        "Memory (GB)": 32,
        "Memory Type": "GDDR7",
        "Memory Bus (bit)": 512,
        "GPU Memory Bandwidth (GB/s)": 1790,
        "Bus": "PCIe 5.0",
        "Cores": 21760,
        "TMUs": 680,
        "ROPs": 176,
        "SM": 170,
        "TC": 680,
        "RT": 170,
        "PR": 424,
        "TR": float('nan'), # Not available in the source data
        "FP16": 104800,
        "FP32": 104800,
        "FP64": 1637.0,
        "$/hr": 0.89
    },
    "L4": {
        "Base Clock (MHz)": 795,
        "Boost Clock (MHz)": 2040,
        "Memory Clock (MHz)": 1563,
        "Memory (GB)": 24,
        "Memory Type": "GDDR6",
        "Memory Bus (bit)": 192,
        "GPU Memory Bandwidth (GB/s)": 300,
        "Bus": "PCIe 4.0",
        "Cores": 7424,
        "TMUs": 240,
        "ROPs": 80,
        "SM": 60,
        "TC": 240,
        "RT": 60,
        "PR": 163,
        "TR": 490.0,
        "FP16": 30290,
        "FP32": 30290,
        "FP64": 473.0,
        "$/hr": 0.71
    },
    "L40S": {
        "Base Clock (MHz)": 1110,
        "Boost Clock (MHz)": 2520,
        "Memory Clock (MHz)": 2250,
        "Memory (GB)": 48,
        "Memory Type": "GDDR6",
        "Memory Bus (bit)": 384,
        "GPU Memory Bandwidth (GB/s)": 864,
        "Bus": "PCIe 4.0",
        "Cores": 18176,
        "TMUs": 568,
        "ROPs": 192,
        "SM": 142,
        "TC": 568,
        "RT": 142,
        "PR": 484,
        "TR": 1431.0,
        "FP16": 91610,
        "FP32": 91610,
        "FP64": float('nan'), # Not available in the source data
        "$/hr": 0.86
    },
    "P4": {
        "Base Clock (MHz)": 886,
        "Boost Clock (MHz)": 1114,
        "Memory Clock (MHz)": 1502,
        "Memory (GB)": 8,
        "Memory Type": "GDDR5",
        "Memory Bus (bit)": 256,
        "GPU Memory Bandwidth (GB/s)": 192,
        "Bus": "PCIe 4.0",
        "Cores": 2560,
        "TMUs": 160,
        "ROPs": 64,
        "SM": 20,
        "TC": 0,
        "RT": 0,
        "PR": 71,
        "TR": 178.0,
        "FP16": 89,
        "FP32": 5704,
        "FP64": 178.0,
        "$/hr": 0.45
    },
    "P100": {
        "Base Clock (MHz)": 1190,
        "Boost Clock (MHz)": 1329,
        "Memory Clock (MHz)": 715,
        "Memory (GB)": 16,
        "Memory Type": "HBM2",
        "Memory Bus (bit)": 4096,
        "GPU Memory Bandwidth (GB/s)": 732,
        "Bus": "PCIe 4.0",
        "Cores": 3584,
        "TMUs": 224,
        "ROPs": 96,
        "SM": 56,
        "TC": 0,
        "RT": 0,
        "PR": 127,
        "TR": 297.0,
        "FP16": 19050,
        "FP32": 9526,
        "FP64": 4763.0,
        "$/hr": 1.06
    }
}

MODEL_SPECS = {
    "mixer": {
        "embed_dim": 128,
        "depth": 10,
        "patch_size": 8,
        "token_mlp_dim": 128,
        "channel_mlp_dim": 512,
        "num_patches": 64,
        "param_count": 1538760,
        "flops_fwd_per_sample": 233648256,
        "flops_train_per_sample": 639565824,
        "flops_train_per_batch": 20466106368,
        "arithmetic_intensity_train": 101.2150609,
        "param_bytes": 6155040,
        "optimizer_state_bytes": 12310080,
        "master_param_bytes": 6155040,
        "total_state_bytes": 24620160,
        "act_bytes_per_sample_proxy": 163840
    },
    "resmlp": {
        "embed_dim": 128,
        "depth": 12,
        "patch_size": 8,
        "token_mlp_dim": 128,
        "channel_mlp_dim": 512,
        "num_patches": 16,
        "param_count": 1627812,
        "flops_fwd_per_sample": 52002816,
        "flops_train_per_sample": 156008448,
        "flops_train_per_batch": 4992270336,
        "arithmetic_intensity_train": 23.78032559,
        "param_bytes": 6511248,
        "optimizer_state_bytes": 13022496,
        "master_param_bytes": 6511248,
        "total_state_bytes": 26044992,
        "act_bytes_per_sample_proxy": 49152
    },
    "asmlp": {
        "embed_dim": 128,
        "depth": 12,
        "patch_size": 8,
        "token_mlp_dim": 128,
        "channel_mlp_dim": 512,
        "num_patches": 64,
        "param_count": 2032200,
        "flops_fwd_per_sample": 255197184,
        "flops_train_per_sample": 765591552,
        "flops_train_per_batch": 24498929664,
        "arithmetic_intensity_train": 91.9584424,
        "param_bytes": 8128800,
        "optimizer_state_bytes": 16257600,
        "master_param_bytes": 8128800,
        "total_state_bytes": 32515200,
        "act_bytes_per_sample_proxy": 196608
    },
    "DistilBERT": {
        "depth": 6,
        "d_model": 256,
        "n_heads": 8,
        "d_head": 32,
        "d_ff": 1024,
        "ffn_multiplier": 4,
        "param_count": 8275970,
        "param_bytes": 33103880,
        "optimizer_state_bytes": 66207760,
        "master_param_bytes": 33103880,
        "total_state_bytes": 132415520,
        "flops_fwd_per_token": 2883584,
        "flops_train_per_seq": 6643777536,
        "flops_train_per_batch": 53150220288,
        "act_bytes_per_seq_proxy": 327680,
        "arithmetic_intensity_train": 198.7277152,
        "loader_ratio": 0.005
    },
    "DeiT-Tiny": {
        "depth": 12,
        "d_model": 192,
        "n_heads": 3,
        "d_head": 64,
        "d_ff": 768,
        "ffn_multiplier": 4,
        "param_count": 5543716,
        "param_bytes": 22174864,
        "optimizer_state_bytes": 44349728,
        "master_param_bytes": 22174864,
        "total_state_bytes": 88699456,
        "flops_fwd_per_token": 5259264,
        "flops_train_per_seq": 37109366784,
        "flops_train_per_batch": 1187499737088,
        "act_bytes_per_seq_proxy": 376320,
        "arithmetic_intensity_train": 1645.561793,
        "loader_ratio": 0.005
    },
    "ViT": {
        "depth": 12,
        "d_model": 768,
        "n_heads": 12,
        "d_head": 64,
        "d_ff": 3072,
        "ffn_multiplier": 4,
        "param_count": 85875556,
        "param_bytes": 343502224,
        "optimizer_state_bytes": 687004448,
        "master_param_bytes": 343502224,
        "total_state_bytes": 1374008896,
        "flops_fwd_per_token": 26345472,
        "flops_train_per_seq": 185893650432,
        "flops_train_per_batch": 743574601728,
        "act_bytes_per_seq_proxy": 1505280,
        "arithmetic_intensity_train": 538.8104556,
        "loader_ratio": 0.005
    },
    "Transformer": {
        "depth": 12,
        "d_model": 512,
        "n_heads": 8,
        "d_head": 64,
        "d_ff": 2048,
        "ffn_multiplier": 4,
        "param_count": 90250544,
        "param_bytes": 361002176,
        "optimizer_state_bytes": 722004352,
        "master_param_bytes": 361002176,
        "total_state_bytes": 1444008704,
        "flops_fwd_per_token": 11534336,
        "flops_train_per_seq": 53150220288,
        "flops_train_per_batch": 425201762304,
        "act_bytes_per_seq_proxy": 655360,
        "arithmetic_intensity_train": 146.9628447,
        "loader_ratio": 0.005
    },
    "ResNet50": {
        "depth": 54,
        "param_count": 23917832,
        "param_bytes": 95671328,
        "optimizer_state_bytes": 95671328,
        "master_param_bytes": 95671328,
        "total_state_bytes": 287013984,
        "flops_fwd_per_sample": 668106752,
        "flops_train_per_sample": 2004320256,
        "flops_train_per_batch": 64138248192,
        "act_bytes_per_sample_proxy": 5230992,
        "arithmetic_intensity_train": 19.86396602,
        "flops_1x1_frac": 0.5179263328,
        "flops_3x3_frac": 0.4520084359,
        "flops_depthwise_frac": 0,
        "flops_grouped_frac": 0,
        "bn_layers": 53,
        "act_layers": 49,
        "sum_hwC": 907264,
        "max_hwC": 65536,
        "loader_ratio": 0.6,
    },
    "VGG16": {
        "depth": 16,
        "param_count": 135088392,
        "param_bytes": 540353568,
        "optimizer_state_bytes": 540353568,
        "master_param_bytes": 540353568,
        "total_state_bytes": 1621060704,
        "flops_fwd_per_sample": 2746286080,
        "flops_train_per_sample": 8238858240,
        "flops_train_per_batch": 263643463680,
        "act_bytes_per_sample_proxy": 6918544,
        "arithmetic_intensity_train": 15.05440906,
        "flops_1x1_frac": 0,
        "flops_3x3_frac": 0.9123493617,
        "flops_depthwise_frac": 0,
        "flops_grouped_frac": 0,
        "bn_layers": 13,
        "act_layers": 15,
        "sum_hwC": 1105920,
        "max_hwC": 262144,
        "loader_ratio": 0.7
    },
    "MobileNetV2": {
        "depth": 53,
        "param_count": 2236682,
        "param_bytes": 8946728,
        "optimizer_state_bytes": 8946728,
        "master_param_bytes": 8946728,
        "total_state_bytes": 26840184,
        "flops_fwd_per_sample": 12249856,
        "flops_train_per_sample": 36749568,
        "flops_train_per_batch": 1175986176,
        "act_bytes_per_sample_proxy": 545172,
        "arithmetic_intensity_train": 3.871676693,
        "flops_1x1_frac": 0.8927713109,
        "flops_3x3_frac": 0.03611209797,
        "flops_depthwise_frac": 0.0690267706,
        "flops_grouped_frac": 0.0690267706,
        "bn_layers": 52,
        "act_layers": 35,
        "sum_hwC": 136288,
        "max_hwC": 24576,
        "loader_ratio": 0.005
    },
    "DenseNet121": {
        "depth": 121,
        "param_count": 7056356,
        "param_bytes": 28225424,
        "optimizer_state_bytes": 28225424,
        "master_param_bytes": 28225424,
        "total_state_bytes": 84676272,
        "flops_fwd_per_sample": 115843072,
        "flops_train_per_sample": 347529216,
        "flops_train_per_batch": 11120934912,
        "act_bytes_per_sample_proxy": 1574088,
        "arithmetic_intensity_train": 11.66224521,
        "flops_1x1_frac": 0.5187751927,
        "flops_3x3_frac": 0.4378756806,
        "flops_depthwise_frac": 0,
        "flops_grouped_frac": 0,
        "bn_layers": 121,
        "act_layers": 120,
        "sum_hwC": 140800,
        "max_hwC": 16384,
        "loader_ratio": 0.002
    }
}

DATASET_SPECS = {
    "CIFAR100": {
        "num_classes": 100,
        "dataset_size": 50000,
    },
    "CIFAR10": {
        "num_classes": 10,
        "dataset_size": 50000,
    },
    "TinyImageNet": {
        "num_classes": 200,
        "dataset_size": 100000,
    },
    "STL10": {
        "num_classes": 10,
        "dataset_size": 5000,
    },
    "SST2": {
        "dataset_size": 67349,
        "seq_len": 128,
        "src_len": 128,
        "tgt_len": float('nan'),
    },
    "IMDB": {
        "dataset_size": 25000,
        "seq_len": 128,
        "src_len": 128,
        "tgt_len": float('nan'),
    },
    "WMT14_EN_DE": {
        "dataset_size": 4508785,
        "seq_len": float('nan'),
        "src_len": 128,
        "tgt_len": 128,
    },
    "CNNDM_SUM": {
        "dataset_size": 287113,
        "seq_len": float('nan'),
        "src_len": 512,
        "tgt_len": 512,
    }
}

CATEGORICAL_GPU_COLS = {
    "Bus": [
        "PCIe 4.0",
        "PCIe 5.0",
    ],
    "Memory Type": [
        "GDDR6",
        "GDDR7",
        "HBM2",
        "HBM2e",
    ],
}

CATEGORICAL_MLP_COLS = {
    "model": [
        "mixer",
        "resmlp",
        "asmlp",
    ],
    "architecture": [
        "MLP"
    ],
    "optimizer": [
        "AdamW",
        "SGD"
    ],
    "dataset": [
        "CIFAR100",
        "TinyImageNet",
        "STL10"
    ]
}

CATEGORICAL_CNN_COLS = {
    "model": [
        "resnet50",
        "mobilenetv2",
        "vgg16",
        "densenet121",
    ],
    "architecture": [
        "CNN"
    ],
    "optimizer": [
        "AdamW",
        "SGD"
    ],
    "dataset": [
        "CIFAR100",
        "CIFAR10",
        "TinyImageNet",
        "STL10"
    ]
}

CATEGORICAL_TRANSFORMER_COLS = {
    "model": [
        "DeiT-Tiny",
        "DistilBERT",
        "ViT"
    ],
    "architecture": [
        "Transformer"
    ],
    "optimizer": [
        "AdamW",
        "Adam",
        "Adafactor"
    ],
    "dataset": [
        "CIFAR100",
        "SST2",
        "IMDB",
        "TinyImageNet",
        "STL10"
    ],
    "task": [
        "vision_cls",
        "text_cls"
    ]
}